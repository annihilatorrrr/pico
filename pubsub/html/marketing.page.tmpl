{{template "base" .}}

{{define "title"}}{{.Site.Domain}} -- pubsub using ssh{{end}}

{{define "meta"}}
<meta name="description" content="pubsub using ssh" />

<meta property="og:type" content="website">
<meta property="og:site_name" content="{{.Site.Domain}}">
<meta property="og:url" content="https://{{.Site.Domain}}">
<meta property="og:title" content="{{.Site.Domain}}">
<meta property="og:description" content="pubsub using ssh">

<meta name="twitter:card" content="summary" />
<meta property="twitter:url" content="https://{{.Site.Domain}}">
<meta property="twitter:title" content="{{.Site.Domain}}">
<meta property="twitter:description" content="pubsub using ssh">
<meta name="twitter:image" content="https://{{.Site.Domain}}/card.png" />
<meta name="twitter:image:src" content="https://{{.Site.Domain}}/card.png" />

<meta property="og:image:width" content="300" />
<meta property="og:image:height" content="300" />
<meta itemprop="image" content="https://{{.Site.Domain}}/card.png" />
<meta property="og:image" content="https://{{.Site.Domain}}/card.png" />
{{end}}

{{define "attrs"}}class="container-sm"{{end}}

{{define "body"}}
<header>
  <h1 class="text-2xl font-bold text-center">pubsub using ssh</h1>
</header>

<hr />

<article>
  <p>
    The simplest authenticated pubsub system.  Send messages through
    user-defined channels.  Channels are private to the authenticated
    ssh user.  The default pubsub model is multicast with bidirectional
    blocking, meaning a publisher (<code>pub</code>) will send its message to all
    subscribers (<code>sub</code>).  Further, both <code>pub</code> and
    <code>sub</code> will wait for at least one event to be sent or received.
  </p>

  <div>
    <h2 class="text-xl">A basic API</h2>
    <pre>ssh {{.Site.Domain}} sub mykey</pre>
    <pre>echo "hello world!" | ssh {{.Site.Domain}} pub mykey</pre>
  </div>

  <div>
    <h2 class="text-xl">Simple desktop notifications</h2>
    <pre>ssh {{.Site.Domain}} sub notify | notify-send</pre>
    <pre>./longjob.sh; echo "Job done!" | ssh {{.Site.Domain}} pub notify</pre>
  </div>

  <div>
    <h2 class="text-xl">Simple CI/CD</h2>
    <pre>ssh {{.Site.Domain}} sub myimg | docker pull myimg && docker up -d dev</pre>
    <pre>docker buildx build --push -t myimg .; ssh {{.Site.Domain}} pub myimg</pre>
  </div>

  <div>
    <h2 class="text-xl">Caveats</h2>
    <p>
      You must always pipe something into <code>pub</code> or else it will block
      indefinitely until the process is killed.
    </p>
  </div>

  <p>
    This project was heavily inspired by
    <a href="https://patchbay.pub">patchbay.pub</a>
  </p>

  <div class="text-center">
    <a href="https://pico.sh/getting-started" class="btn-link my-2 inline-block">GET STARTED</a>
  </div>
</article>

{{template "marketing-footer" .}}
{{end}}
